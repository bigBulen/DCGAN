# DCGAN python实现

这是一个基于 PyTorch 的深度卷积生成对抗网络（DCGAN）实现。该代码遵循了原始 DCGAN 论文中的架构，并允许你在自己的数据集上训练 GAN。
这个项目基于基于https://github.com/pytorch/examples/tree/main/dcgan 并进行改进。

## 功能特点
- **数据增强：** 自定义裁剪和填充图像为正方形进行训练。
- **灵活的训练参数：** 可以调整批次大小、图像尺寸、学习率等。
- **模型保存：** 在训练过程中定期保存模型。
- **生成图像样本：** 定期保存生成的图像，帮助观察训练进度。

## 环境要求
- Python 3.x
- PyTorch
- TorchVision
- Numpy
- Matplotlib（可选，用于可视化生成的图像）

# 食用方法
## 1.准备数据集
将你的数据集放在 train_images 文件夹中，或者在 dataroot 选项中指定数据集路径。
数据集应该是一个文件夹，其中每个子文件夹代表一个类别。
## 2.调参
可以修改以下选项来调整训练：
- batchSize: 每个批次的图像数量（默认为 370）。
- imageSize: 目标图像尺寸（默认为 256）。
- nz: 潜在变量（z）的维度（默认为 100）。
- ngf 和 ndf: 生成器和判别器的卷积层数量（默认为 64）。
- niter: 训练的轮数（默认为 450）。
- lr: 学习率（默认为 0.00035）。
- beta1: Adam 优化器的 beta1 参数（默认为 0.5）。
- cuda: 是否使用 GPU（如果有 CUDA 支持，设置为 True）。

## 3.开始训练（直接运行即可）

## 4.生成样本
训练过程中，生成的图像和训练权重文件将被保存在 results 文件夹中。

# 数据预处理部分
- 图像裁剪：CustomCrop 类用于将图像裁剪为正方形，通过剪掉较长边的一部分。如果你想修改裁剪比例或禁用此功能，可以修改该类。

- 填充：图像在缩放前会被填充为正方形。如果你希望修改填充行为，可以调整 pad_to_square() 函数。
